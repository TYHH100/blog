<!DOCTYPE html>
<script>
function extractServerAddress() {
  const origin = new URL(window.location.origin);
  const pathSegments = window.location.href
    .replace(origin, '')
    .split('/')
    .filter(Boolean);
  
  const connectIndex = pathSegments.indexOf('connect');
  return (connectIndex !== -1 && pathSegments[connectIndex + 1]) 
    || window.location.pathname.split('/').pop();
}

function redirect() {
  try {
    const serverAddress = extractServerAddress();
    if (!serverAddress || !/\S+:\d+/.test(serverAddress)) {
      throw new Error('服务器地址格式无效');
    }
    
    window.location.href = `steam://connect/${serverAddress}`;
    document.getElementById('fallbackLink').href = `steam://connect/${serverAddress}`;
    
    setTimeout(() => {
      document.getElementById('redirectState').textContent = '手动跳转';
    }, 3000);
    
  } catch (error) {
    document.getElementById('errorMsg').textContent = error.message;
    document.getElementById('errorMsg').style.display = 'block';
  }
}
window.addEventListener('DOMContentLoaded', redirect);
</script>

<body style="margin:0;padding:20px;font-family:sans-serif;text-align:center">
  <h1 id="redirectState">启动Steam连接中...</h1>
  <div id="errorMsg" style="color:#c00;display:none"></div>
  <p>如未自动跳转，<a id="fallbackLink" href="">请点击这里</a></p>
</body>